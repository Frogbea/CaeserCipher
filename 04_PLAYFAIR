# v1 making the matrix
# v2 removing spaces and puncuation from inputs
# v3 rejecting numbers
# v4 spliting the input
#imports

import string as st

#constants
playkey = 'poise'

#functions

def noNum(Ninput):
    while True:
        noNumInput = input(Ninput).replace(' ', '')
        if any(char.isdigit() for char in noNumInput):
            print('Please do not enter any numbers')
            continue
        else:
            break
    return noNumInput

def matrixKey(key):
    key = key.upper()
    matrix = [[0 for i in range (5)] for j in range(5)]
    charAdd = []
    row = 0
    col = 0
    # add key word to matrix
    for letter in key:
        # add key word to the top of the matrix
        if letter not in charAdd:
            matrix[row][col] = letter
            charAdd.append(letter)
        else:
            continue
        # cuts off column at four
        if (col == 4):
            col = 0
            row += 1
        # makes new column when column does not equal 4
        else:
            col += 1
    # add rest of alphebet to matrix
    for letter in range(65, 91):
        # take out j playfair only uses 25 letters
        if letter == 74:
            continue
        # add letter if its not already there
        if chr(letter) not in charAdd:
            charAdd.append(chr(letter))
        index = 0
    # cutes off each column
    for i in range(5):
        for j in range(5):
            matrix[i][j] = charAdd[index]
            index += 1
    return matrix
'''
def pair(message):
    pair = []
    group = 0
    for i in range(2, len(message), 2):
        pair.append(message[group:i])
        group = i
    pair.append(message[group:])
    return pair
'''
def sameChar(message):
    j = len(message)
    if j % 2 == 0:
        for i in range(0, j, 2):
            if message[i] == message[i + 1]:
                newWord = message[0: i + 1] + str('X') + message[i + 1]
                newWord = sameChar(newWord)
                break
            else:
                newWord = message
    else:
        for i in range(0, j - 1, 2):
            if message[i] == message[i + 1]:
                newWord = message[0: i + 1] + str('X') + message[i + 1:]
                newWord = sameChar(newWord)
        else:
            newWord = message
    return newWord

def index(letter, matrix):
    for i in range (5):
        try:
            index = matrix[i].index(letter)
            return(1, index)
        except:
            continue

def playEncode(key, message):
    inc = 1
    if decode:
        inc = -1
    matrix = matrixKey(key)
    message = sameChar(message)
    cipherText = ''
    for (l1, l2) in zip(message[0::2], message[1::2]):
        row1, col1 = index(l1, matrix)
        row2, col2 = index(l2, matrix)
        if row1 == row2:
            cipherText += matrix[row1][(col1 + inc) % 5] + matrix[row2][(col2 + inc) % 5]
        elif col1 == col2:
            cipherText += matrix[(row1 + inc) % 5][col1] + matrix[(row2 + inc) % 5][col2]
        else:
            cipherText += matrix[row1][col2] + matrix[row2][col1]
    return cipherText

#***************************************************************************************************
#MAIN
# this is the key table for the cipher
Matrix = matrixKey(playkey)
decode = False
orgInput = noNum('Please enter the message you would like to encode:')
playFairEn = orgInput.translate(str.maketrans('', '', st.punctuation)).replace(' ', '').upper()
answer = playEncode(playkey, playFairEn)
print(answer)
test = input('Would u like to decode? y/n')
if test == 'y':
    decode = True
    playFairDc = input('Enter your message:')
    answer = playEncode(playkey, playFairDc)
    print(answer)
